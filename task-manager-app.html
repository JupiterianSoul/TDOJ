<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskMaster Pro - Gestion de TÃ¢ches Intelligente</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-primary: #ffffff;
            --bg-secondary: #f3f4f6;
            --bg-tertiary: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --border: #d1d5db;
            --shadow: rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #475569;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: var(--transition);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 20px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            animation: slideIn 0.5s ease;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        /* Navigation */
        nav {
            background: var(--bg-secondary);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 80px;
            z-index: 999;
            backdrop-filter: blur(10px);
        }

        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-item {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.95rem;
            font-weight: 500;
            position: relative;
        }

        .nav-item:hover {
            color: var(--primary);
            background: var(--bg-primary);
        }

        .nav-item.active {
            color: var(--primary);
            background: var(--bg-primary);
            box-shadow: 0 2px 10px var(--shadow);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -1rem;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: var(--primary);
            border-radius: 2px;
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            animation: fadeIn 0.5s ease;
        }

        /* Stats Dashboard */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
            animation: slideUp 0.6s ease;
        }

        .stat-card {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: 0 4px 15px var(--shadow);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Task Input Section */
        .task-input-section {
            background: var(--bg-secondary);
            padding: 2rem;
            border-radius: var(--radius);
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px var(--shadow);
            animation: slideUp 0.7s ease;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-control {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        input, select, textarea {
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: var(--transition);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        /* Filters */
        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            animation: slideUp 0.8s ease;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--border);
            background: var(--bg-primary);
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Tasks Container */
        .tasks-container {
            display: grid;
            gap: 1rem;
            animation: slideUp 0.9s ease;
        }

        .task-card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: 0 2px 10px var(--shadow);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.3s ease;
        }

        .task-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 20px var(--shadow);
        }

        .task-card.completed {
            opacity: 0.7;
        }

        .task-card.completed .task-title {
            text-decoration: line-through;
            color: var(--text-secondary);
        }

        .task-priority {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
        }

        .task-priority.high { background: var(--danger); }
        .task-priority.medium { background: var(--warning); }
        .task-priority.low { background: var(--success); }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .task-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .task-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .task-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.85rem;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
        }

        .task-btn {
            padding: 0.5rem;
            border: none;
            background: var(--bg-tertiary);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
        }

        .task-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        /* Progress Bar */
        .progress-container {
            margin-top: 1rem;
            background: var(--bg-tertiary);
            border-radius: 20px;
            height: 8px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 20px;
            transition: width 0.5s ease;
        }

        /* Mini Game */
        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .game-container {
            background: var(--bg-primary);
            border-radius: var(--radius);
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .game-canvas {
            width: 100%;
            height: 400px;
            background: linear-gradient(180deg, #87CEEB 0%, #98D8E8 100%);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .dino {
            position: absolute;
            bottom: 0;
            left: 50px;
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 10px;
            transition: bottom 0.2s;
        }

        .dino.jump {
            bottom: 120px;
        }

        .obstacle {
            position: absolute;
            bottom: 0;
            right: -50px;
            width: 30px;
            height: 40px;
            background: var(--danger);
            border-radius: 5px;
            animation: moveObstacle 2s linear;
        }

        @keyframes moveObstacle {
            to {
                right: 100%;
            }
        }

        .game-score {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-primary);
            padding: 2rem;
            border-radius: var(--radius);
            text-align: center;
            display: none;
            box-shadow: 0 10px 40px var(--shadow);
        }

        .game-over h3 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--danger);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-primary);
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            box-shadow: 0 10px 40px var(--shadow);
            z-index: 3000;
            display: none;
            animation: slideIn 0.3s ease;
            border-left: 4px solid var(--primary);
        }

        .notification.show {
            display: block;
        }

        .notification.success {
            border-left-color: var(--success);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        /* Pomodoro Timer */
        .pomodoro-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: var(--radius);
            box-shadow: 0 4px 20px var(--shadow);
            z-index: 1500;
            min-width: 200px;
        }

        .timer-display {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .timer-controls {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        .timer-btn {
            padding: 0.5rem 1rem;
            border: none;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .timer-btn:hover {
            background: var(--primary-dark);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .nav-content {
                justify-content: center;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .input-group {
                grid-template-columns: 1fr;
            }

            .filters {
                justify-content: center;
            }

            .pomodoro-widget {
                bottom: 10px;
                right: 10px;
                left: 10px;
            }
        }

        /* Loading Animation */
        .loader {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        /* Drag and Drop */
        .dragging {
            opacity: 0.5;
            cursor: move;
        }

        .drag-over {
            background: var(--bg-tertiary);
            border: 2px dashed var(--primary);
        }

        /* Settings Modal */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .settings-content {
            background: var(--bg-primary);
            border-radius: var(--radius);
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .settings-section {
            margin-bottom: 2rem;
        }

        .settings-section h3 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .color-picker {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
        }

        .color-option:hover,
        .color-option.selected {
            border-color: var(--text-primary);
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">â</div>
                <span>TaskMaster Pro</span>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" id="themeToggle">ð</button>
                <button class="btn btn-secondary" onclick="openSettings()">âï¸ ParamÃ¨tres</button>
                <button class="btn btn-secondary" onclick="exportTasks()">ð¥ Export</button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav>
        <div class="nav-content">
            <button class="nav-item active" data-view="dashboard">ð Tableau de bord</button>
            <button class="nav-item" data-view="tasks">ð TÃ¢ches</button>
            <button class="nav-item" data-view="calendar">ð Calendrier</button>
            <button class="nav-item" data-view="stats">ð Statistiques</button>
            <button class="nav-item" onclick="openGame()">ð® Mini-Jeu</button>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Stats Dashboard -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ð</div>
                <div class="stat-value" id="totalTasks">0</div>
                <div class="stat-label">TÃ¢ches totales</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â</div>
                <div class="stat-value" id="completedTasks">0</div>
                <div class="stat-label">TÃ¢ches terminÃ©es</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â³</div>
                <div class="stat-value" id="pendingTasks">0</div>
                <div class="stat-label">En attente</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ð¥</div>
                <div class="stat-value" id="streakDays">0</div>
                <div class="stat-label">Jours consÃ©cutifs</div>
            </div>
        </div>

        <!-- Task Input Section -->
        <div class="task-input-section">
            <h2 style="margin-bottom: 1.5rem;">â Nouvelle tÃ¢che</h2>
            <div class="input-group">
                <div class="form-control">
                    <label for="taskTitle">Titre de la tÃ¢che</label>
                    <input type="text" id="taskTitle" placeholder="Ex: Finir le rapport...">
                </div>
                <div class="form-control">
                    <label for="taskCategory">CatÃ©gorie</label>
                    <select id="taskCategory">
                        <option value="work">ð¼ Travail</option>
                        <option value="personal">ð¤ Personnel</option>
                        <option value="urgent">ð¨ Urgent</option>
                        <option value="shopping">ð Courses</option>
                        <option value="health">ðª SantÃ©</option>
                    </select>
                </div>
                <div class="form-control">
                    <label for="taskPriority">PrioritÃ©</label>
                    <select id="taskPriority">
                        <option value="low">Faible</option>
                        <option value="medium">Moyenne</option>
                        <option value="high">Haute</option>
                    </select>
                </div>
                <div class="form-control">
                    <label for="taskDeadline">ÃchÃ©ance</label>
                    <input type="datetime-local" id="taskDeadline">
                </div>
            </div>
            <div class="form-control">
                <label for="taskDescription">Description</label>
                <textarea id="taskDescription" placeholder="DÃ©tails de la tÃ¢che..."></textarea>
            </div>
            <button class="btn btn-primary" onclick="addTask()">
                <span>â</span>
                <span>Ajouter la tÃ¢che</span>
            </button>
        </div>

        <!-- Filters -->
        <div class="filters">
            <button class="filter-btn active" data-filter="all">Toutes</button>
            <button class="filter-btn" data-filter="today">Aujourd'hui</button>
            <button class="filter-btn" data-filter="week">Cette semaine</button>
            <button class="filter-btn" data-filter="work">ð¼ Travail</button>
            <button class="filter-btn" data-filter="personal">ð¤ Personnel</button>
            <button class="filter-btn" data-filter="urgent">ð¨ Urgent</button>
            <button class="filter-btn" data-filter="completed">â TerminÃ©es</button>
        </div>

        <!-- Tasks Container -->
        <div class="tasks-container" id="tasksContainer">
            <div class="empty-state">
                <div class="empty-state-icon">ð</div>
                <h3>Aucune tÃ¢che pour le moment</h3>
                <p>Commencez par ajouter votre premiÃ¨re tÃ¢che!</p>
            </div>
        </div>
    </div>

    <!-- Pomodoro Timer Widget -->
    <div class="pomodoro-widget">
        <div class="timer-display" id="timerDisplay">25:00</div>
        <div class="timer-controls">
            <button class="timer-btn" onclick="startTimer()">â¶ï¸</button>
            <button class="timer-btn" onclick="pauseTimer()">â¸ï¸</button>
            <button class="timer-btn" onclick="resetTimer()">ð</button>
        </div>
    </div>

    <!-- Game Modal -->
    <div class="game-modal" id="gameModal">
        <div class="game-container">
            <div class="game-header">
                <h2>ð® Dino Jump Challenge</h2>
                <button class="btn btn-secondary" onclick="closeGame()">âï¸ Fermer</button>
            </div>
            <div class="game-canvas" id="gameCanvas">
                <div class="dino" id="dino"></div>
                <div class="game-score">Score: <span id="gameScore">0</span></div>
                <div class="game-over" id="gameOver">
                    <h3>Game Over!</h3>
                    <p>Score final: <span id="finalScore">0</span></p>
                    <button class="btn btn-primary" onclick="restartGame()">Rejouer</button>
                </div>
            </div>
            <p style="margin-top: 1rem; text-align: center; color: var(--text-secondary);">
                Cliquez ou appuyez sur Espace pour sauter!
            </p>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <div class="settings-header">
                <h2>âï¸ ParamÃ¨tres</h2>
                <button class="btn btn-secondary" onclick="closeSettings()">âï¸</button>
            </div>
            
            <div class="settings-section">
                <h3>ð¨ Couleur d'accent</h3>
                <div class="color-picker">
                    <div class="color-option" style="background: #6366f1" data-color="#6366f1"></div>
                    <div class="color-option" style="background: #ec4899" data-color="#ec4899"></div>
                    <div class="color-option" style="background: #10b981" data-color="#10b981"></div>
                    <div class="color-option" style="background: #f59e0b" data-color="#f59e0b"></div>
                    <div class="color-option" style="background: #ef4444" data-color="#ef4444"></div>
                    <div class="color-option" style="background: #8b5cf6" data-color="#8b5cf6"></div>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>ð Notifications</h3>
                <label style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <input type="checkbox" id="enableNotifications" checked>
                    <span>Activer les notifications</span>
                </label>
                <label style="display: flex; align-items: center; gap: 1rem;">
                    <input type="checkbox" id="enableSound" checked>
                    <span>Activer les sons</span>
                </label>
            </div>
            
            <div class="settings-section">
                <h3>ð¾ DonnÃ©es</h3>
                <button class="btn btn-secondary" onclick="importTasks()" style="margin-right: 1rem;">ð¤ Importer</button>
                <button class="btn btn-primary" onclick="exportTasks()">ð¥ Exporter</button>
                <button class="btn btn-secondary" onclick="clearAllTasks()" style="margin-left: 1rem; background: var(--danger); color: white;">ðï¸ Tout effacer</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notificationText"></span>
    </div>

    <script>
        // Application State
        let tasks = [];
        let currentFilter = 'all';
        let gameRunning = false;
        let gameScore = 0;
        let timerInterval = null;
        let timerSeconds = 1500; // 25 minutes
        let isDarkMode = false;

        // Initialize Application
        document.addEventListener('DOMContentLoaded', () => {
            loadTasks();
            updateStats();
            renderTasks();
            initializeEventListeners();
            checkTheme();
            requestNotificationPermission();
        });

        // Event Listeners
        function initializeEventListeners() {
            // Theme Toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Filters
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    renderTasks();
                });
            });
            
            // Color Picker
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.color-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    document.documentElement.style.setProperty('--primary', this.dataset.color);
                    localStorage.setItem('accentColor', this.dataset.color);
                });
            });
            
            // Game Controls
            document.getElementById('gameCanvas').addEventListener('click', jump);
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space' && gameRunning) {
                    e.preventDefault();
                    jump();
                }
            });
            
            // Auto-save
            setInterval(saveTasks, 30000); // Save every 30 seconds
        }

        // Theme Management
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.documentElement.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');
            document.getElementById('themeToggle').textContent = isDarkMode ? 'âï¸' : 'ð';
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        }

        function checkTheme() {
            const savedTheme = localStorage.getItem('theme');
            const savedColor = localStorage.getItem('accentColor');
            
            if (savedTheme === 'dark') {
                isDarkMode = true;
                document.documentElement.setAttribute('data-theme', 'dark');
                document.getElementById('themeToggle').textContent = 'âï¸';
            }
            
            if (savedColor) {
                document.documentElement.style.setProperty('--primary', savedColor);
                document.querySelector(`.color-option[data-color="${savedColor}"]`)?.classList.add('selected');
            }
        }

        // Task Management
        function addTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const category = document.getElementById('taskCategory').value;
            const priority = document.getElementById('taskPriority').value;
            const deadline = document.getElementById('taskDeadline').value;
            const description = document.getElementById('taskDescription').value.trim();
            
            if (!title) {
                showNotification('Veuillez entrer un titre pour la tÃ¢che', 'error');
                return;
            }
            
            const task = {
                id: Date.now(),
                title,
                category,
                priority,
                deadline,
                description,
                completed: false,
                createdAt: new Date().toISOString(),
                subtasks: []
            };
            
            tasks.unshift(task);
            saveTasks();
            renderTasks();
            updateStats();
            clearForm();
            showNotification('TÃ¢che ajoutÃ©e avec succÃ¨s!', 'success');
            
            // Schedule notification if deadline is set
            if (deadline) {
                scheduleNotification(task);
            }
        }

        function deleteTask(id) {
            if (confirm('Ãtes-vous sÃ»r de vouloir supprimer cette tÃ¢che?')) {
                tasks = tasks.filter(task => task.id !== id);
                saveTasks();
                renderTasks();
                updateStats();
                showNotification('TÃ¢che supprimÃ©e', 'success');
            }
        }

        function toggleTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                if (task.completed) {
                    task.completedAt = new Date().toISOString();
                    celebrate();
                }
                saveTasks();
                renderTasks();
                updateStats();
            }
        }

        function editTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskCategory').value = task.category;
                document.getElementById('taskPriority').value = task.priority;
                document.getElementById('taskDeadline').value = task.deadline;
                document.getElementById('taskDescription').value = task.description;
                deleteTask(id);
            }
        }

        // Render Tasks
        function renderTasks() {
            const container = document.getElementById('tasksContainer');
            const filteredTasks = filterTasks();
            
            if (filteredTasks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ð</div>
                        <h3>Aucune tÃ¢che trouvÃ©e</h3>
                        <p>Ajoutez une nouvelle tÃ¢che ou changez le filtre</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredTasks.map(task => `
                <div class="task-card ${task.completed ? 'completed' : ''}" draggable="true" data-id="${task.id}">
                    <div class="task-priority ${task.priority}"></div>
                    <div class="task-header">
                        <div>
                            <h3 class="task-title">${escapeHtml(task.title)}</h3>
                            <div class="task-meta">
                                <span class="task-badge">${getCategoryIcon(task.category)} ${getCategoryName(task.category)}</span>
                                <span class="task-badge">â¡ ${getPriorityName(task.priority)}</span>
                                ${task.deadline ? `<span class="task-badge">ð ${formatDate(task.deadline)}</span>` : ''}
                            </div>
                            ${task.description ? `<p style="margin-top: 0.5rem; color: var(--text-secondary);">${escapeHtml(task.description)}</p>` : ''}
                        </div>
                        <div class="task-actions">
                            <button class="task-btn" onclick="toggleTask(${task.id})" title="Marquer comme ${task.completed ? 'non terminÃ©e' : 'terminÃ©e'}">
                                ${task.completed ? 'â©ï¸' : 'â'}
                            </button>
                            <button class="task-btn" onclick="editTask(${task.id})" title="Modifier">âï¸</button>
                            <button class="task-btn" onclick="deleteTask(${task.id})" title="Supprimer">ðï¸</button>
                        </div>
                    </div>
                    ${task.subtasks && task.subtasks.length > 0 ? renderSubtasks(task.subtasks) : ''}
                </div>
            `).join('');
            
            // Initialize drag and drop
            initializeDragAndDrop();
        }

        function renderSubtasks(subtasks) {
            return `
                <div class="subtasks" style="margin-top: 1rem;">
                    ${subtasks.map(subtask => `
                        <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <input type="checkbox" ${subtask.completed ? 'checked' : ''}>
                            <span style="${subtask.completed ? 'text-decoration: line-through;' : ''}">${escapeHtml(subtask.title)}</span>
                        </label>
                    `).join('')}
                </div>
            `;
        }

        // Filter Tasks
        function filterTasks() {
            let filtered = [...tasks];
            
            switch(currentFilter) {
                case 'today':
                    filtered = filtered.filter(task => {
                        if (!task.deadline) return false;
                        const deadline = new Date(task.deadline);
                        const today = new Date();
                        return deadline.toDateString() === today.toDateString();
                    });
                    break;
                case 'week':
                    filtered = filtered.filter(task => {
                        if (!task.deadline) return false;
                        const deadline = new Date(task.deadline);
                        const today = new Date();
                        const weekFromNow = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
                        return deadline <= weekFromNow;
                    });
                    break;
                case 'completed':
                    filtered = filtered.filter(task => task.completed);
                    break;
                case 'work':
                case 'personal':
                case 'urgent':
                    filtered = filtered.filter(task => task.category === currentFilter);
                    break;
            }
            
            return filtered.sort((a, b) => {
                if (a.completed !== b.completed) return a.completed ? 1 : -1;
                if (a.priority !== b.priority) {
                    const priorityOrder = { high: 0, medium: 1, low: 2 };
                    return priorityOrder[a.priority] - priorityOrder[b.priority];
                }
                return new Date(b.createdAt) - new Date(a.createdAt);
            });
        }

        // Statistics
        function updateStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const pending = total - completed;
            const streak = calculateStreak();
            
            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('pendingTasks').textContent = pending;
            document.getElementById('streakDays').textContent = streak;
            
            // Update progress if exists
            const progress = completed > 0 ? (completed / total) * 100 : 0;
            document.querySelectorAll('.progress-bar').forEach(bar => {
                bar.style.width = `${progress}%`;
            });
        }

        function calculateStreak() {
            // Simple streak calculation
            const today = new Date().toDateString();
            const todayCompleted = tasks.some(t => 
                t.completed && new Date(t.completedAt).toDateString() === today
            );
            return todayCompleted ? 1 : 0;
        }

        // Storage
        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        function loadTasks() {
            const saved = localStorage.getItem('tasks');
            if (saved) {
                tasks = JSON.parse(saved);
            }
        }

        function exportTasks() {
            const dataStr = JSON.stringify(tasks, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `tasks_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('TÃ¢ches exportÃ©es avec succÃ¨s!', 'success');
        }

        function importTasks() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = event => {
                    try {
                        const imported = JSON.parse(event.target.result);
                        tasks = [...tasks, ...imported];
                        saveTasks();
                        renderTasks();
                        updateStats();
                        showNotification('TÃ¢ches importÃ©es avec succÃ¨s!', 'success');
                    } catch (error) {
                        showNotification('Erreur lors de l\'importation', 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        function clearAllTasks() {
            if (confirm('Ãtes-vous sÃ»r de vouloir supprimer toutes les tÃ¢ches? Cette action est irrÃ©versible.')) {
                tasks = [];
                saveTasks();
                renderTasks();
                updateStats();
                showNotification('Toutes les tÃ¢ches ont Ã©tÃ© supprimÃ©es', 'success');
            }
        }

        // Mini Game
        let obstacleInterval;
        let jumpTimeout;
        
        function openGame() {
            document.getElementById('gameModal').style.display = 'flex';
            resetGame();
        }
        
        function closeGame() {
            document.getElementById('gameModal').style.display = 'none';
            gameRunning = false;
            clearInterval(obstacleInterval);
        }
        
        function startGame() {
            gameRunning = true;
            gameScore = 0;
            document.getElementById('gameScore').textContent = gameScore;
            document.getElementById('gameOver').style.display = 'none';
            
            obstacleInterval = setInterval(() => {
                if (gameRunning) {
                    createObstacle();
                    gameScore += 10;
                    document.getElementById('gameScore').textContent = gameScore;
                }
            }, 2000);
        }
        
        function createObstacle() {
            const canvas = document.getElementById('gameCanvas');
            const obstacle = document.createElement('div');
            obstacle.className = 'obstacle';
            canvas.appendChild(obstacle);
            
            // Check collision
            const checkCollision = setInterval(() => {
                const dino = document.getElementById('dino');
                const dinoRect = dino.getBoundingClientRect();
                const obstacleRect = obstacle.getBoundingClientRect();
                
                if (obstacleRect.left < dinoRect.right && 
                    obstacleRect.right > dinoRect.left &&
                    obstacleRect.bottom > dinoRect.top &&
                    obstacleRect.top < dinoRect.bottom) {
                    endGame();
                    clearInterval(checkCollision);
                }
                
                if (obstacleRect.right < 0) {
                    obstacle.remove();
                    clearInterval(checkCollision);
                }
            }, 10);
        }
        
        function jump() {
            if (!gameRunning && !document.getElementById('gameOver').style.display) {
                startGame();
                return;
            }
            
            const dino = document.getElementById('dino');
            if (!dino.classList.contains('jump')) {
                dino.classList.add('jump');
                clearTimeout(jumpTimeout);
                jumpTimeout = setTimeout(() => {
                    dino.classList.remove('jump');
                }, 500);
            }
        }
        
        function endGame() {
            gameRunning = false;
            clearInterval(obstacleInterval);
            document.getElementById('finalScore').textContent = gameScore;
            document.getElementById('gameOver').style.display = 'block';
            
            // Save high score
            const highScore = localStorage.getItem('highScore') || 0;
            if (gameScore > highScore) {
                localStorage.setItem('highScore', gameScore);
                showNotification(`Nouveau record! Score: ${gameScore}`, 'success');
            }
        }
        
        function resetGame() {
            gameRunning = false;
            gameScore = 0;
            clearInterval(obstacleInterval);
            document.getElementById('gameScore').textContent = '0';
            document.getElementById('gameOver').style.display = 'none';
            document.querySelectorAll('.obstacle').forEach(o => o.remove());
        }
        
        function restartGame() {
            resetGame();
            startGame();
        }

        // Pomodoro Timer
        function startTimer() {
            if (!timerInterval) {
                timerInterval = setInterval(() => {
                    timerSeconds--;
                    updateTimerDisplay();
                    
                    if (timerSeconds <= 0) {
                        pauseTimer();
                        showNotification('Pomodoro terminÃ©! Prenez une pause.', 'success');
                        playSound();
                    }
                }, 1000);
            }
        }
        
        function pauseTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
        }
        
        function resetTimer() {
            pauseTimer();
            timerSeconds = 1500; // 25 minutes
            updateTimerDisplay();
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Settings
        function openSettings() {
            document.getElementById('settingsModal').style.display = 'flex';
        }
        
        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        // Notifications
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = `notification show ${type}`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }
        
        function scheduleNotification(task) {
            if (!task.deadline) return;
            
            const deadline = new Date(task.deadline);
            const now = new Date();
            const timeDiff = deadline - now;
            
            if (timeDiff > 0) {
                setTimeout(() => {
                    if (document.getElementById('enableNotifications')?.checked && 
                        'Notification' in window && 
                        Notification.permission === 'granted') {
                        new Notification('TaskMaster Pro', {
                            body: `Rappel: ${task.title}`,
                            icon: 'â',
                            badge: 'â'
                        });
                    }
                    showNotification(`Rappel: ${task.title}`, 'warning');
                }, timeDiff);
            }
        }

        // Utility Functions
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            const options = { day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' };
            return date.toLocaleDateString('fr-FR', options);
        }
        
        function getCategoryIcon(category) {
            const icons = {
                work: 'ð¼',
                personal: 'ð¤',
                urgent: 'ð¨',
                shopping: 'ð',
                health: 'ðª'
            };
            return icons[category] || 'ð';
        }
        
        function getCategoryName(category) {
            const names = {
                work: 'Travail',
                personal: 'Personnel',
                urgent: 'Urgent',
                shopping: 'Courses',
                health: 'SantÃ©'
            };
            return names[category] || category;
        }
        
        function getPriorityName(priority) {
            const names = {
                low: 'Faible',
                medium: 'Moyenne',
                high: 'Haute'
            };
            return names[priority] || priority;
        }
        
        function clearForm() {
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskDescription').value = '';
            document.getElementById('taskDeadline').value = '';
            document.getElementById('taskCategory').value = 'work';
            document.getElementById('taskPriority').value = 'medium';
        }
        
        function celebrate() {
            // Simple celebration animation
            const colors = ['#6366f1', '#8b5cf6', '#10b981', '#f59e0b'];
            const confetti = [];
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.style.position = 'fixed';
                particle.style.width = '10px';
                particle.style.height = '10px';
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particle.style.left = Math.random() * window.innerWidth + 'px';
                particle.style.top = '-20px';
                particle.style.borderRadius = '50%';
                particle.style.zIndex = '9999';
                particle.style.pointerEvents = 'none';
                document.body.appendChild(particle);
                confetti.push(particle);
                
                // Animate
                let pos = -20;
                const gravity = 0.5;
                let velocity = Math.random() * 3 + 2;
                
                const animate = () => {
                    velocity += gravity;
                    pos += velocity;
                    particle.style.top = pos + 'px';
                    particle.style.transform = `rotate(${pos * 2}deg)`;
                    
                    if (pos < window.innerHeight) {
                        requestAnimationFrame(animate);
                    } else {
                        particle.remove();
                    }
                };
                
                requestAnimationFrame(animate);
            }
        }
        
        function playSound() {
            if (document.getElementById('enableSound')?.checked) {
                // Create a simple beep sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            }
        }
        
        // Drag and Drop
        function initializeDragAndDrop() {
            const cards = document.querySelectorAll('.task-card');
            
            cards.forEach(card => {
                card.addEventListener('dragstart', handleDragStart);
                card.addEventListener('dragover', handleDragOver);
                card.addEventListener('drop', handleDrop);
                card.addEventListener('dragend', handleDragEnd);
            });
        }
        
        let draggedElement = null;
        
        function handleDragStart(e) {
            draggedElement = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
        }
        
        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            
            const afterElement = getDragAfterElement(e.currentTarget, e.clientY);
            const dragging = document.querySelector('.dragging');
            
            if (afterElement == null) {
                e.currentTarget.appendChild(dragging);
            } else {
                e.currentTarget.insertBefore(dragging, afterElement);
            }
            
            return false;
        }
        
        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            if (draggedElement !== this) {
                // Reorder tasks array
                const draggedId = parseInt(draggedElement.dataset.id);
                const targetId = parseInt(this.dataset.id);
                
                const draggedIndex = tasks.findIndex(t => t.id === draggedId);
                const targetIndex = tasks.findIndex(t => t.id === targetId);
                
                if (draggedIndex !== -1 && targetIndex !== -1) {
                    const [removed] = tasks.splice(draggedIndex, 1);
                    tasks.splice(targetIndex, 0, removed);
                    saveTasks();
                }
            }
            
            return false;
        }
        
        function handleDragEnd(e) {
            document.querySelectorAll('.task-card').forEach(card => {
                card.classList.remove('dragging');
                card.classList.remove('drag-over');
            });
        }
        
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.task-card:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }
        
        // Keyboard Shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + N: New task
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                document.getElementById('taskTitle').focus();
            }
            
            // Ctrl/Cmd + E: Export
            if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                e.preventDefault();
                exportTasks();
            }
            
            // Ctrl/Cmd + D: Toggle dark mode
            if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                e.preventDefault();
                toggleTheme();
            }
            
            // Escape: Close modals
            if (e.key === 'Escape') {
                closeGame();
                closeSettings();
            }
        });

        // PWA Support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').catch(() => {
                    // Service worker registration failed
                });
            });
        }

        // Performance optimization: Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Optimize search/filter with debounce
        const optimizedRenderTasks = debounce(renderTasks, 300);

        // Auto-save with debounce
        const autoSave = debounce(saveTasks, 1000);
    </script>
</body>
</html>